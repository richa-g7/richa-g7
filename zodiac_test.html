<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Yes/No Questions</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<h1> The Zodiac Test</h1>

<form id="ZodiacForm">
  <label for="q1"> What is your zodiac sign? </label>
  <select id="q1">
<!--      <option selected="true" style='display: none'></option>  -->
       <option hidden> --please select-- </option>

    <option value="Aries" >Aries</option>
    <option value="Taurus">Taurus</option>
    <option value="Gemini">Gemini</option>
    <option value="Cancer">Cancer</option>
    <option value="Leo">Leo</option>
    <option value="Virgo">Virgo</option>
    <option value="Libra">Libra</option>
    <option value="Scorpio">Scorpio</option>
    <option value="Sagittarius">Sagittarius</option>
    <option value="Capricorn">Capricorn</option>
    <option value="Aquarius">Aquarius</option>
    <option value="Pisces">Pisces</option>
  </select><br><br>

    <label for="q2"> What is your zodiac sign? </label>
  
  <select id="q2">
<!--      <option selected="true" style='display: none'></option>  -->
       <option hidden> --please select-- </option>

    <option value="Aries" >Aries</option>
    <option value="Taurus">Taurus</option>
    <option value="Gemini">Gemini</option>
    <option value="Cancer">Cancer</option>
    <option value="Leo">Leo</option>
    <option value="Virgo">Virgo</option>
    <option value="Libra">Libra</option>
    <option value="Scorpio">Scorpio</option>
    <option value="Sagittarius">Sagittarius</option>
    <option value="Capricorn">Capricorn</option>
    <option value="Aquarius">Aquarius</option>
    <option value="Pisces">Pisces</option>
  </select><br><br>

<button type="button" onclick="submitForm()">Submit</button>
        <button type="button" id='button2' onclick="retun()">Return</button>
        <script>
                document.getElementById("button2").style.display = 'none';
        </script>

    

<p>Compatability Score: <span id="yesCount">0</span></p>

</form>  

</body>
</html>

<script>
  function submitForm() {

  const astrotypes = ["Aries", "Taurus", "Gemini", "Cancer", "Leo", "Virgo", "Libra", "Scorpio", "Sagittarius", "Capricorn", "Aquarius", "Pisces"];
  let p1 = astrotypes.indexOf(document.getElementById("q1").value);
  let p2 = astrotypes.indexOf(document.getElementById("q2").value);

  fetch("https://im.notsingle.club/percent_zodiac.txt")
    .then(response => response.text())
    .then(data => {
      const lines = data.split('\n');
      const line = lines[p1];
      const lineArray = line.split(' ');
      document.getElementById("yesCount").innerHTML = lineArray[p2].slice(0, -1);
        document.getElementById("button2").style.display = 'block';
      score = document.getElementById("yesCount").innerHTML;
      if(sessionStorage.getItem("tests_taken") == null) {
                    sessionStorage.setItem("tests_taken", 1);
                     var hey = parseInt(document.getElementById("yesCount").innerHTML);
                     // console.log( hey );
                     // console.log(document.getElementById("yesCount").innerHTML);
                    sessionStorage.setItem("score", score);
        } else {
                    var tt = parseInt(sessionStorage.getItem("tests_taken"));
                    var s = parseInt(sessionStorage.getItem("score"));
                  var score = parseInt(document.getElementById("yesCount").innerHTML);

                     console.log(tt);
                     console.log(s);
           console.log(s*tt);
           console.log(s*tt + score);
           console.log((s*tt + score) / (tt+1));
           console.log(Math.trunc((s*tt + score) / (tt+1)));
                      
          
                    var new_score = Math.trunc( (s*tt + score) / (tt+1) );
                      tt += 1;
                    
                   
                    sessionStorage.setItem("tests_taken", tt );
                    sessionStorage.setItem("score", new_score );
                }
                              // var hey = parseInt(lineArray[p2].slice(0, -1));
        // console.log( hey );

    })
    .catch(error => {
      console.error('Error reading file:', error);
    });


                      
          

}

    


        function retun() {
                window.location.href = "index.html";
                
        }
  
</script>

